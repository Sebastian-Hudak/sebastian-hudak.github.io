<script>
    const header = document.getElementById("header");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 5) header.classList.add("on-scroll");
      else header.classList.remove("on-scroll");
    });
  </script>

  <script>
    (function () {
      const buttons = document.querySelectorAll(".projects__filter");
      const cards = document.querySelectorAll(".project-card");

      function setActive(btn) {
        buttons.forEach(b => b.classList.remove("is-active"));
        btn.classList.add("is-active");
      }

      function filterCards(tag) {
        cards.forEach(card => {
          const tags = (card.getAttribute("data-tags") || "")
            .split(",")
            .map(t => t.trim())
            .filter(Boolean);

          const show = tag === "all" || tags.includes(tag);
          card.classList.toggle("is-hidden", !show);
        });
      }

      buttons.forEach(btn => {
        btn.addEventListener("click", () => {
          const tag = btn.getAttribute("data-filter");
          setActive(btn);
          filterCards(tag);
        });
      });
    })();
  </script>


  <script>
  (function () {
    const burger = document.querySelector(".burger");
    const nav = document.querySelector(".nav");
    if (!burger || !nav) return;

    burger.addEventListener("click", () => {
      const open = nav.classList.toggle("is-open");
      burger.classList.toggle("is-active", open);
      burger.setAttribute("aria-expanded", open ? "true" : "false");
    });

    // Close menu when a link is clicked (mobile)
    nav.querySelectorAll("a").forEach(a => {
      a.addEventListener("click", () => {
        nav.classList.remove("is-open");
        burger.classList.remove("is-active");
        burger.setAttribute("aria-expanded", "false");
      });
    });
  })();
</script>


<script>
  (function () {
    const items = document.querySelectorAll(".reveal");

    if (!items.length) return;

    const obs = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("is-visible");
            obs.unobserve(entry.target); // animate only once
          }
        });
      },
      {
        threshold: 0.15,
        rootMargin: "0px 0px -10% 0px"
      }
    );

    items.forEach((el) => obs.observe(el));
  })();

  document.addEventListener("DOMContentLoaded", () => {
  const cards = document.querySelectorAll(".education-card");

  const io = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        // add when it becomes visible enough
        if (entry.isIntersecting) entry.target.classList.add("is-inview");
        else entry.target.classList.remove("is-inview"); // optional
      });
    },
    {
      root: null,
      threshold: 0.55,              // ~55% visible triggers it
      rootMargin: "0px 0px -10% 0px" // trigger slightly before center
    }
  );

  cards.forEach((c) => io.observe(c));
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const flips = document.querySelectorAll(".flip");

  flips.forEach((flip) => {
    flip.addEventListener("click", (e) => {
      e.stopPropagation();
      flip.classList.toggle("is-flipped");
    });
  });

  document.addEventListener("click", () => {
    flips.forEach((f) => f.classList.remove("is-flipped"));
  });

  // optional: allow Esc to close when focused (desktop)
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") flips.forEach((f) => f.classList.remove("is-flipped"));
  });
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const grid = document.querySelector("#projectsGrid");
  const dotsWrap = document.querySelector(".projects__dots");
  if (!grid || !dotsWrap) return;

  const allCards = Array.from(grid.querySelectorAll(".project-card"));

  const isVisible = (el) => {
    // works for .is-hidden { display:none } and other hiding methods
    return !!(el.offsetWidth || el.offsetHeight || el.getClientRects().length);
  };

  let io = null;

  function buildDots() {
    // only cards currently visible after filtering
    const cards = allCards.filter(isVisible);

    // hide dots completely if 0/1 slides
    dotsWrap.innerHTML = "";
    dotsWrap.style.display = (cards.length <= 1) ? "none" : "flex";

    // disconnect old observer
    if (io) io.disconnect();
    if (!cards.length) return;

    // create dots
    const dots = cards.map((_, i) => {
      const b = document.createElement("button");
      b.className = "projects__dot";
      b.type = "button";
      b.setAttribute("aria-label", `Go to project ${i + 1}`);
      b.addEventListener("click", () => {
        cards[i].scrollIntoView({ behavior: "smooth", inline: "start", block: "nearest" });
      });
      dotsWrap.appendChild(b);
      return b;
    });

    const setActive = (idx) => {
      dots.forEach((d, i) => d.classList.toggle("is-active", i === idx));
    };

    // observe visible cards to update dot
    io = new IntersectionObserver((entries) => {
      entries.forEach((e) => {
        if (e.isIntersecting) {
          const idx = cards.indexOf(e.target);
          if (idx !== -1) setActive(idx);
        }
      });
    }, { root: grid, threshold: 0.6 });

    cards.forEach(c => io.observe(c));

    // set active dot
setActive(0);

// Only auto-scroll the horizontal carousel on MOBILE,
// and only if the Projects section is already near the viewport.
const isMobileCarousel = window.matchMedia("(max-width: 600px)").matches;
const projSection = grid.closest(".projects");
const nearProjects = projSection && projSection.getBoundingClientRect().top < window.innerHeight * 0.6;

if (isMobileCarousel && nearProjects) {
  cards[0].scrollIntoView({ behavior: "auto", inline: "center", block: "nearest" });
}
  }

  // initial build
  buildDots();

  // Rebuild dots when filtering changes cards visibility
  // If your filter buttons toggle .is-hidden, this catches it.
  const mo = new MutationObserver(() => buildDots());
  mo.observe(grid, { attributes: true, subtree: true, attributeFilter: ["class", "style"] });

  // Also rebuild after clicking filter buttons (instant feedback)
  document.querySelectorAll(".projects__filter").forEach(btn => {
    btn.addEventListener("click", () => {
      // wait a tick for your existing filter JS to apply classes
      requestAnimationFrame(buildDots);
    });
  });
});
</script>